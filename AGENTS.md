# 프로젝트 의도 설명
내가 참여하고 있는 카카오톡 오픈 채팅방의 지난 대화 내역으로부터 중요한 레슨과 인싸이트를 추출하고자 한다.

# 원본 파일 설명
카카오톡 오픈채팅방에서 추출해낸 대화 내역과 첨부파일을 프로젝트 디렉토리 하위 data 폴더에 넣어두었다.
* 대화 내용: 'Talk_YYYY.M.D HH_mm-n.txt' 파일에 다 들어가 있다
  * 예: `Talk_2026.1.27 21_37-1.txt`
  * 월/일은 한 자리일 때 0 패딩 없음, 날짜와 시간 사이 공백
* 사진 및 첨부파일: YYYYMMDD_HHMMSS(_n)?.(jpeg|jpg|png|webp|pdf)
  * 이미지: `20250725_200815_1.jpeg` (번호 있음)
  * PDF: `20250922_180822.pdf` (번호 없음)
* 참고: 카카오톡 내보내기는 이미지와 PDF만 저장함
  * 대화에서 공유된 .html, .wav, .mp4, .zip, .xlsx 등은 내보내기에서 제외됨
  * 대화 내 "파일: {원본파일명}" 메시지의 파일명과 data 폴더의 실제 파일명은 다름

# 대화 내용 패턴
## 시스템 메시지 예시
* 첫행부터 5행까지는 제목 행 (1행: 파일명, 2행: 저장 날짜, 3-5행: 빈 줄)
* 각 날짜별로 "YYYY년 M월 D일 d요일" 형식의 한 줄로 내용이 시작돼.
* "YYYY. M. D. HH:mm: {사용자 이름}님이 들어왔습니다."
* "YYYY. M. D. HH:mm: {사용자 이름}님이 나갔습니다."
* "메시지가 삭제되었습니다."

## 일반 대화
* "YYYY. M. D. HH:mm, {사용자 이름} : {발언 내용, 긴 발언은 줄바꿈을 포함함}"
* "YYYY. M. D. HH:mm, {사용자 이름} : 파일: {파일명}"
* "YYYY. M. D. HH:mm, {사용자 이름} : 사진"
* "YYYY. M. D. HH:mm, {사용자 이름} : 이모티콘"

# 할 일
## 1단계: 대화 내용 확인
* 대화 내용 파일과 기타 첨부 파일 이름 등을 확인하여 AGENTS.md 파일에 기술된 내용 패턴 및 파일명 패턴이 일치하는지 확인
## 2단계: 대화 포맷 재구성
* 대화 내용을 메시지 패턴을 고려하여 csv로 재구성하는 프로그램을 작성
* 대화 내용 중 시스템 메시지는 포함하지 않아도 좋음
* 한 사용자의 발화가 연속되는 경우 첫 발화에 줄바꿈으로 이어 붙일 것
* 단, 사진/파일/이모티콘 메시지는 별도 행으로 유지 (병합하지 않음)
* 사진/파일 메시지에 data 폴더의 실제 파일 경로 매핑 (타임스탬프 기반)
## 2-1단계: 간이 시각화 도구
* html 어플리케이션으로 캘린더 또는 슬라이드를 통해 타임라인을 이동하며 날짜별 대화 내용을 조회한다.
* 카카오톡 내보내기 ZIP 파일을 직접 선택하면 파싱과 뷰어가 한 번에 동작하도록 한다.
* 채상욱 리더의 발언을 하이라이트하고 스크롤 마커로 빠르게 찾을 수 있게 한다.
## 3단계: 요약 추출 
* 별도의 파일에 날짜별 요약을 정리한 파일을 작성한다.
* 날짜별 요약을 다시 정리하여 총 정리 파일을 작성한다.
## 4단계: 시각화 도구
* html 어플리케이션으로 캘린더 또는 슬라이드를 통해 타임라인을 이동하며 날짜별 요약을 조회하고, 총 정리를 조회하고 검색/조회하는 기능을 만든다. 

# 작업 지침
* 파이썬 3.12 사용
* 개발 과정에서 추가되는 의존성은 pyproject.toml에 기술, uv.lock 생성
* 구조 변경시 사용법, 구조 설명 등을 README.md에 업데이트

# 진행상황

## 1단계: 완료 (2026-02-03)
* 상세 결과: [RESULT_STEP1.md](RESULT_STEP1.md)
* 데이터 규모: 95,786줄, 195일, 첨부파일 165개
* 발견사항:
  * 퇴장 메시지 패턴 누락 → AGENTS.md에 추가
  * 이모티콘 메시지 패턴 누락 → AGENTS.md에 추가
  * 파일명 패턴 상세화 (0패딩, 공백 등)
  * 기존 parse_kakao_chat.py는 45줄에서 중단된 미완성 상태

## 2단계: 완료 (2026-02-03, 수정)
* parse_kakao_chat.py 완성 (335줄)
* 출력: parsed_chat.csv
* 파싱 결과:
  * 메시지 수: 42,958개 (텍스트만 병합, 첨부파일은 별도 행)
  * 참여자: 824명
  * 대화 일수: 189일
  * 사진: 1,617건, 파일: 61건, 이모티콘: 219건, 링크: 1,204건
  * 첨부파일 매핑: 110건 (이미지 89건, PDF 21건)
* CSV 컬럼: datetime, date, time, user, message_type, content, has_attachment, attachment_type, attachment_ref, attachment_path, has_link, word_count
* 변경사항:
  * 사진/파일/이모티콘은 병합하지 않고 별도 행으로 유지
  * attachment_path 컬럼 추가 (data 폴더 내 실제 파일 경로)
  * 타임스탬프 기반 파일 매핑 (±30분 허용)

## 2-1단계: 완료 (2026-02-03, ZIP 통합 + 가이드 추가)
* index.html 생성 (단일 HTML 파일, 서버 불필요, ~1.8MB)
* **ZIP 통합**: 카카오톡 내보내기 ZIP 파일을 직접 선택하면 파싱과 뷰어가 한 번에 동작
  * Python 스크립트 실행 불필요
  * JSZip 라이브러리 사용 (CDN)
  * 브라우저 내 대화 파싱 (JavaScript 포팅)
  * 첨부파일 Blob URL로 메모리 내 로딩
  * 진행 상태 프로그레스바 표시
* **사용 가이드 내장**: 스크린샷 6장을 base64로 HTML에 포함
  * 카카오톡 내보내기 방법 (4단계)
  * 뷰어 사용 방법 (2단계)
  * 마우스 오버 시 이미지 확대
* 기능:
  * ZIP 파일 선택 (카카오톡 내보내기 파일)
  * 월별 캘린더 네비게이션
  * 날짜별 대화 목록
  * 메시지 검색 기능
  * 사진 표시 및 확대 보기
  * PDF/파일 링크
* UI 특징:
  * 채상욱 리더 발언 하이라이트 (황금색 배경)
  * 채상욱 리더 이름에 왕관 이모지 표시
  * 사용자 이름은 말풍선 왼쪽에 별도 배치
  * 스크롤 마커로 리더 발언 위치 표시 및 빠른 이동
* 배포: GitHub Pages 등 정적 호스팅 가능 (서버 불필요, 클라이언트 사이드 처리)
* 사용법: index.html 더블클릭 → ZIP 파일 선택 → 자동 파싱 후 대화 보기
